<!DOCTYPE html>
<html>
<head>
	<title>Batmanreturns</title>
	<%= stylesheet_link_tag 'screen.css', :media => 'screen, projection' %>
	<%= stylesheet_link_tag 'print.css', :media => 'print' %>
	<!--[if lt IE 8]><%= stylesheet_link_tag 'ie.css', :media => 'screen, projection' %><![endif]-->
	<%= javascript_include_tag :defaults %>„ÄÅ
	<%= csrf_meta_tag %>
</head>
<div id="header">
	<div id="headerContent">
		<h1 id="name"><a href="/">iFixit</a></h1>
		<ul id="headerIcons">
			<li id="headerRepair">
				<a href="/Guide">Repair</a>
			</li>
			<li id="headerAnswers" class="active">
				<a href="/Answers/">Answers</a>
			</li>
			<li id="headerContribute">
				<a href="/Contribute">Contribute</a>
			</li>
			<li id="headerParts">
				<a href="/Parts-Store">Parts &amp; Tools</a>
			</li>
		</ul>
	</div>
</div>
<body class="bp two-col">
	<% if current_user %>
	    <ul id="notifications">
	    <%current_user.notifications.find_all_by_read(false).each do |notification|%>
			<li class="notification">
			<% if notification.notification_type_id == 1  %>
	      		<%= new_answer_notification(notification.user_id,notification.user_name, notification.question_id, notification.question_title) %>
			<% elsif notification.notification_type_id == 5 %>
				<%= new_accept_answer(notification.user_id,notification.user_name,notification.question_id, notification.question_title) %>
			<% elsif notification.notification_type_id == 6 %>
				<%= new_comment_on_q(notification.user_id,notification.user_name,notification.question_id, notification.question_title) %>
			<% elsif notification.notification_type_id == 7 %>
				<%= new_comment_on_a(notification.user_id,notification.user_name,notification.question_id, notification.answer_content) %>
			<% elsif notification.notification_type_id == 8 %>
				<%= new_follower(notification.user_id,notification.user_name) %>
			<% end %>
			</li>
	    <% end %>
	    </ul>
	<% end %>
	
	<script>
    	var pusher = new Pusher('2f20b4687fdaada149b2');
    	var c = pusher.subscribe("presence-channel_<%= current_user.id %>");

    	c.bind('notification_created', function(notification) {
    		$('#notifications').append("<li class='notifications'><div class='strong'><p><a href='/users/" + notification.user_id + "'>" + notification.user_name + "</a>" + notification.type + "<a href='/questions/" + notification.obj_id + "'>" + notification.remark + "</a></p></div></li>");
    	});

    </script>
    
	<div id="container">
		<%= yield %>
	</div>
</body>
</html>
